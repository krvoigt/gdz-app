{% extends 'base.html.twig' %}

{% if query is not empty %}
    {% set title = query %}
{% endif %}

{% block findnavigation %}
    <div class="resultCount">{{ pagination.getTotalItemCount | number_format(0, ',', '.') }} {% trans %}numfound{% endtrans %}</div>
   {{ knp_pagination_render(pagination) }}
{% endblock %}

{% block body %}

    <ol class="resultList" start="{{ offset + 1 }}">
        {% for result in pagination %}
            <li>
                <article>
                    <h1><a href="{{ path('subugoe_find_detail', {'id': result.fields.id}) }}">{{ result.fields.bytitle }}</a></h1>
                    <p>{% if result.fields.creator is defined %}
                            {{ 'creator' | transchoice(result.fields.creator | length) }}:
                                {% for author in result.fields.creator %}
                                  {{ author }}{% if loop.last %}{% else %}, {% endif %}
                                {% endfor %}
                            <br>
                            {% endif %}

                        {{ result.fields.docstrct | trans }}
                    </p>

                    {% if result.fields.thumbs_url is defined %}
                        <img src="{{ result.fields.thumbs_url.0 }}" alt="">
                    {% endif %}
                </article>
            </li>
        {% endfor %}
    </ol>
{% endblock %}

{% block sidebar %}
    {% for key, facet in facets %}
        <article class="facet">
            <h1>{{ key | transchoice(facet | length) }}</h1>
            <ol class="facetList">
                {% for value, count in facet if count > 0 %}
                    {% set facet_name = ['facet', key]|join('-') %}
                    <li class="facetItem">
                        <a class="facetItemLink" href="{{ path('subugoe_find_homepage', {
                            'filter': queryParams|merge({
                                (facetCounter):  {
                                    (key) : (value)
                                }
                            }),
                        'q': (app.request.get('q'))
                        }) }}">{{ value | trans }} <span class="facetCount">{{ count | number_format(0, ',', '.') }}</span></a>
                    </li>
                {% endfor %}
            </ol>
            <button class="facetListExpand">{% trans %}expand{% endtrans %}</button>
            <button class="facetListCollapse">{% trans %}collapse{% endtrans %}</button>
        </article>
    {% endfor %}
{% endblock %}
